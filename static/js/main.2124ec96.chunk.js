(this.webpackJsonpdemo=this.webpackJsonpdemo||[]).push([[0],{121:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateNestedGraph=void 0;var o=n(310);t.generateNestedGraph=function(e){var t=o.generateNG(e||{});return{nodes:t.getAllNodes(),links:t.getAllLinks()}}},125:function(e,t,n){e.exports=n.p+"static/media/logo.e385133d.svg"},126:function(e,t,n){e.exports=n(314)},131:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){},309:function(e,t,n){},310:function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.generateNG=void 0;var r=n(311),i=n(312),a=n(313);var u=10,s=.1,c=.1,d=!1;t.generateNG=function(e){if(e){if(void 0!==e.nodeCount&&e.nodeCount<=0)throw new Error("nodeCount must be greater than zero");if(void 0!==e.nestedNessRatio&&!(e.nestedNessRatio>=0&&e.nestedNessRatio<=1))throw new Error("nestedNessRatio must be in the range [0, 1.0]");if(void 0!==e.outBoundLinkRatio&&!(e.outBoundLinkRatio>=0&&e.outBoundLinkRatio<=1))throw new Error("outBoundLinkRatio must be in the range [0, 1.0]")}return function(e){for(var t=new a.NestedGraph(new Array(e.nodeCount).fill(null).map((function(e,t){return{id:t.toString()}}))),n=function(n){if(r.eventHappened(e.nestedNessRatio)){var i=t.getAllNodes().filter((function(e){return e.id!==n.id&&!t.isAncestor(e.id,n.id)}));i.length>0&&t.updateNode(n.id,o(o({},n),{parentId:i[r.randomNumber(i.length-1)].id}))}},u=0,s=t.getAllNodes();u<s.length;u++){n(p=s[u])}for(var c=[],d=0,l=t.getAllNodes();d<l.length;d++)for(var p=l[d],f=0,h=t.getAllNodesFromOtherSubTrees(p.id);f<h.length;f++){var m=h[f];r.eventHappened(e.outBoundLinkRatio)&&(e.loopsAllowed||i.isAcyclicGraph(c.concat([{sourceId:p.id,targetId:m.id}])))&&c.push({sourceId:p.id,targetId:m.id})}return t.setLinks(c),t}({nodeCount:void 0!==e.nodeCount?e.nodeCount:u,nestedNessRatio:void 0!==e.nestedNessRatio?e.nestedNessRatio:s,outBoundLinkRatio:void 0!==e.outBoundLinkRatio?e.outBoundLinkRatio:c,loopsAllowed:void 0!==e.loopsAllowed?e.loopsAllowed:d})}},311:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.eventHappened=t.randomNumber=void 0,t.randomNumber=function(e){return Math.floor(Math.random()*e)},t.eventHappened=function(e){return Math.random()>=1-e}},312:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAcyclicGraph=void 0,t.isAcyclicGraph=function(e){for(var t=function(){var t=e.reduce((function(e,t){var n=t.sourceId,o=t.targetId;return e[n]=e[n]||[],e[n].push(o),e}),{}),n=Object.keys(e.map((function(e){return[e.sourceId,e.targetId]})).reduce((function(e,t){return t.forEach((function(t){return e[t]=!0})),e}),{})).filter((function(e){return!(t[e]&&t[e].length>0)})).reduce((function(e,t){return e[t]=!0,e}),{}),o=e.filter((function(e){return!n[e.targetId]}));if(o.length===e.length)return{value:!1};e=o};e.length>0;){var n=t();if("object"===typeof n)return n.value}return!0}},313:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NestedGraph=void 0;var o=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.nodesMap={},this.setNodes(e),this.links=t}return e.prototype.setNodes=function(e){var t=this;this.nodesMap={},e.forEach((function(e){return t.nodesMap[e.id]=e}))},e.prototype.updateNode=function(e,t){this.nodesMap[e]=t},e.prototype.setLinks=function(e){this.links=e},e.prototype.findNode=function(e){return this.nodesMap[e]},e.prototype.getAllNodes=function(){var e=this;return Object.keys(this.nodesMap).map((function(t){return e.nodesMap[t]}))},e.prototype.getAllLinks=function(){return this.links},e.prototype.isAncestor=function(e,t){var n=this.findNode(e);return!(!n||void 0===n.parentId)&&(n.parentId===t||this.isAncestor(n.parentId,t))},e.prototype.findRootNode=function(e){var t=this.findNode(e);if(t)return t.parentId?void this.findRootNode(t.parentId):t},e.prototype.getAllNodesInSubGraph=function(e){var t=this,n=this.findNode(e);return n?this.getAllNodes().filter((function(n){return t.isAncestor(n.id,e)})).concat([n]):[]},e.prototype.getAllNodesFromOtherSubTrees=function(e){var t=this.findRootNode(e);if(t){var n=this.getAllNodesInSubGraph(t.id).map((function(e){return e.id})).reduce((function(e,t){return e[t]=!0,e}),{});return this.getAllNodes().filter((function(e){return!n[e.id]}))}return[]},e}();t.NestedGraph=o},314:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),i=n(119),a=(n(131),n(132),n(64)),u=n(1),s=(n(133),n(317)),c=n(120),d=n(63),l=Object(s.a)().x((function(e){return e.x})).y((function(e){return e.y})).curve(c.a);function p(e){return[{x:e.x,y:e.y},{x:e.x+e.width/2,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height/2},{x:e.x+e.width,y:e.y+e.height},{x:e.x+e.width/2,y:e.y+e.height},{x:e.x,y:e.y+e.height},{x:e.x,y:e.y+e.height/2}]}function f(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}function h(e,t){var n=p(e),o=p(t),r=n.map((function(e){return o.map((function(t){return[e,t]}))})).reduce((function(e,t){return e.concat(t)}),[]);return r.sort((function(e,t){return f(e[0],e[1])-f(t[0],t[1])})),r[0]}function m(e,t,n){return{x:e.x+t,y:e.y+n}}function g(e,t){var n=function(e,t,n,o){var r=new d.graphlib.Graph;return r.setGraph(Object(u.a)(Object(u.a)({},o),{},{compound:n.length>0})),r.setDefaultEdgeLabel((function(){return{}})),e.forEach((function(e){return r.setNode(e.id.toString(),e.size)})),t.filter((function(e){return!n.some((function(t){return t.parentId===e.sourceId||t.parentId===e.targetId}))})).forEach((function(e){return r.setEdge(e.sourceId,e.targetId)})),n.forEach((function(e){return r.setParent(e.id,e.parentId)})),Object(d.layout)(r),{nodes:r.nodes().map((function(e){var t,n,o=r.node(e);return{id:e,size:{width:o.width,height:o.height},position:(t=o,n=o,{x:t.x-n.width/2,y:t.y-n.height/2})}})),links:r.edges().map((function(e){return{sourceId:e.v,targetId:e.w,points:r.edge(e).points}})),size:{width:r.graph().width||0,height:r.graph().height||0}}}(t.map((function(e){var t=e.element,n=e.size;return{id:t.id,size:n}})),e.getLinksConnectingNodes(t.map((function(e){return e.element.id}))),[],{marginx:45,marginy:45});return{nodes:t.map((function(e){var t=n.nodes.find((function(t){return t.id===e.element.id})).position;return function e(t,n,o){return Object(u.a)(Object(u.a)({},t),{},{position:m(t.position,n,o),links:t.links.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{points:e.points.map((function(e){return m(e,n,o)}))})})),children:t.children.map((function(t){return e(t,n,o)}))})}(e,t.x-e.position.x,t.y-e.position.y)})),links:n.links.map((function(e){return{element:e,points:e.points}})),size:n.size}}function v(e){for(var t=e.nodes,n=[];t.length>0;)n=n.concat(t),t=t.map((function(e){return e.children})).reduce((function(e,t){return e.concat(t)}),[]);return n}function y(e){for(var t=e.links,n=e.nodes;n.length>0;)t=t.concat(n.map((function(e){return e.links})).reduce((function(e,t){return e.concat(t)}),[])),n=n.map((function(e){return e.children})).reduce((function(e,t){return e.concat(t)}),[]);return t}function N(e,t){var n=y(e),o=v(e).reduce((function(e,t){return e[t.element.id]=t,e}),{});return t.getAllLinks().filter((function(e){return!n.some((function(t){return t.element.sourceId===e.sourceId&&t.element.targetId===e.targetId}))})).map((function(e){return t=o[e.sourceId],n=o[e.targetId],{element:e,points:h(Object(u.a)(Object(u.a)({},t.size),t.position),Object(u.a)(Object(u.a)({},n.size),n.position))};var t,n}))}function b(e){var t=g(e,e.getAllRootNodes().map((function(t){return function e(t,n){var o=n.getAllChildrenNodes(t.id);if(o.length>0){var r=o.map((function(t){return e(t,n)})),i=g(n,r),a=i.nodes,u=i.links;return{element:t,children:a,size:i.size,position:{x:0,y:0},links:u}}return{element:t,children:[],size:{width:400,height:150},position:{x:0,y:0},links:[]}}(t,e)})));return Object(u.a)(Object(u.a)({},t),{},{links:t.links.concat(N(t,e))})}var k=function(e){var t=e.link,n="hsl("+360*Math.random()+",80%,48%)";return r.a.createElement("g",{className:"link link-source=".concat(t.element.sourceId," link-target=").concat(t.element.targetId)},r.a.createElement("path",{stroke:"grey",strokeWidth:"2",fill:"none",d:l(t.points)||void 0}),r.a.createElement("circle",{fill:n,cx:t.points[t.points.length-1].x,cy:t.points[t.points.length-1].y,r:12}),r.a.createElement("circle",{fill:n,cx:t.points[0].x,cy:t.points[0].y,r:8}))},E=Object(o.memo)((function(e){var t=e.layout,n=v(t),o=y(t);return r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(t.size.width," ").concat(t.size.height),style:{width:"100%",height:"100%"}},n.map((function(e){return r.a.createElement("g",{key:e.element.id,className:"node ".concat(e.element.id)},r.a.createElement("rect",{x:e.position.x,y:e.position.y,width:e.size.width,height:e.size.height,style:{stroke:"black",fillOpacity:0,strokeWidth:5,strokeOpacity:1}}),r.a.createElement("text",{x:e.position.x+30,y:e.position.y+30},"".concat(e.element.name," (").concat(e.position.x,", ").concat(e.position.y,")")))})),o.map((function(e){return r.a.createElement(k,{link:e,key:"".concat(e.element.sourceId,"-").concat(e.element.targetId)})})))})),w=(n(309),function(e){var t=e.config,n=e.onSubmit,o=e.onChange,i=t.loopsAllowed,a=t.nestedNessRatio,s=t.outBoundLinkRatio,c=t.nodeCount;return r.a.createElement("form",{className:"graph-config-form",onSubmit:function(e){e.preventDefault(),n(t)}},r.a.createElement("label",{htmlFor:"loopsAllowed"},r.a.createElement("span",null,"Loops Allowed"),r.a.createElement("input",{id:"loopsAllowed",type:"checkbox",checked:i,onChange:function(){return o(Object(u.a)(Object(u.a)({},t),{},{loopsAllowed:!t.loopsAllowed}))}})),r.a.createElement("label",{htmlFor:"nodeCount"},r.a.createElement("span",null,"Node Count"),r.a.createElement("input",{id:"nodeCount",type:"number",min:"1",max:"100",step:"1",value:c,onChange:function(e){return o(Object(u.a)(Object(u.a)({},t),{},{nodeCount:+e.target.value}))}})),r.a.createElement("label",{htmlFor:"nestedNessRatio"},r.a.createElement("span",null,"Nestedness Ratio"),r.a.createElement("input",{id:"nestedNessRatio",type:"number",min:"0",max:"1",step:"0.1",value:a,onChange:function(e){return o(Object(u.a)(Object(u.a)({},t),{},{nestedNessRatio:+e.target.value}))}})),r.a.createElement("label",{htmlFor:"outBoundLinkRatio"},r.a.createElement("span",null,"Outbound Links Ratio"),r.a.createElement("input",{id:"outBoundLinkRatio",type:"number",min:"0",max:"1",step:"0.01",value:s,onChange:function(e){return o(Object(u.a)(Object(u.a)({},t),{},{outBoundLinkRatio:+e.target.value}))}})),r.a.createElement("button",{type:"submit"},"New Graph"))});var x=n(121),O=n(122),j=n(123),A=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(O.a)(this,e),this.nodesMap=void 0,this.links=void 0,this.nodesMap=new Map,this.setNodes(t),this.links=n}return Object(j.a)(e,[{key:"setNodes",value:function(e){var t=this;this.nodesMap=new Map,e.forEach((function(e){return t.nodesMap.set(e.id,e)}))}},{key:"updateNode",value:function(e,t){this.nodesMap.set(e,t)}},{key:"setLinks",value:function(e){this.links=e}},{key:"findNode",value:function(e){return this.nodesMap.get(e)}},{key:"getAllNodes",value:function(){return Array.from(this.nodesMap.values())}},{key:"getAllRootNodes",value:function(){return this.getAllNodes().filter((function(e){return void 0===e.parentId}))}},{key:"getAllLinks",value:function(){return this.links}},{key:"getAllChildrenNodes",value:function(e){return this.getAllNodes().filter((function(t){return t.parentId===e}))}},{key:"getLinksConnectingNodes",value:function(e){var t=new Set(e);return this.getAllLinks().filter((function(e){return t.has(e.sourceId)&&t.has(e.targetId)}))}}]),e}(),I=n(124),_=n.n(I);function R(e){var t=Object(x.generateNestedGraph)(e),n=b(new A(t.nodes.map((function(e,t){return Object(u.a)(Object(u.a)({},e),{},{name:"Graph-Node ".concat(t)})})),t.links));return{graph:t,layout:n}}var M,L,C={loopsAllowed:!1,nodeCount:(M=5,L=10,Math.round(Math.random()*(L-M)+M)),nestedNessRatio:.2,outBoundLinkRatio:.3},G=R(C),z=function(){var e=Object(o.useState)(C),t=Object(a.a)(e,2),n=t[0],i=t[1],u=Object(o.useState)(G),s=Object(a.a)(u,2),c=s[0],d=c.graph,l=c.layout,p=s[1];return r.a.createElement("div",{className:"compound-graph-page"},r.a.createElement("div",{className:"compound-graph-page__info"},r.a.createElement("div",{className:"compound-graph-page__params__section"},r.a.createElement("h4",{className:"compound-graph-page__params__section__header"},"Configuration"),r.a.createElement("div",{className:"compound-graph-page__params__section__body"},r.a.createElement(w,{config:n,onChange:i,onSubmit:function(){return p(R(n))}})))),r.a.createElement("div",{className:"compound-graph-page__json"},r.a.createElement(_.a,{src:d,name:null,displayDataTypes:!1,displayObjectSize:!1})),r.a.createElement("div",{className:"compound-graph-page__draw-area"},r.a.createElement(E,{layout:l})))},B=n(125),S=n.n(B);var P=function(){return r.a.createElement("div",{className:"main"},r.a.createElement("header",{className:"header"},r.a.createElement("a",{className:"app-name",href:"/"},r.a.createElement("img",{alt:"Logo",src:S.a}),"Nested Graph Generator")),r.a.createElement("div",{className:"content"},r.a.createElement(z,null)))},F=document.getElementById("root");Object(i.render)(o.createElement(P,null),F)}},[[126,1,2]]]);
//# sourceMappingURL=main.2124ec96.chunk.js.map